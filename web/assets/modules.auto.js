var modules = {"buildings":{"admin_controller":"<?php\n\n$arrayReturn = [];\n\n\/*\n* Add module buildings to the game menu\n*\/\n\n$game->registerMenu('buildings');\n\n\/*\n* Create a new Building\n*\/\n\n$newBuilding = null;\n\n$newBuilding = $game->createElementIfInRequest('newBuilding', [\n    'type' => 'Building',\n]);\n\n\/*\n* Edit an existant Building\n*\/\n\n$game->updateElementsIfInRequest('buildings');\n\n\/*\n* Delete a Building\n*\/\n\n$game->deleteElementIfInRequest('removeBuilding');\n\n\/*\n* Retrieve all buildings\n*\/\n\n$arrayReturn['buildings'] = $game->getElementsByProperties([\n    'type' => 'Building',\n]);\n\nreturn $arrayReturn;\n","admin_template":"<!-- Tabs -->\n<div ng-init=\"$parent.tabs = {}; $parent.currentModuleTab=false\"><\/div>\n\n<div class=\"row card\">\n    <div class=\"col s12\">\n      <ul class=\"tabs\">\n        <li class=\"tab col s3\" ng-repeat=\"(key, tabName) in tabs\">\n            <a ng-click=\"$parent.currentModuleTab = key\" ng-class=\"{active: $parent.currentModuleTab == key}\">\n                {{ tabName }}\n            <\/a>\n        <\/li>\n      <\/ul>\n    <\/div>\n<\/div>\n\n<div ng-init=\"tabs ? tabs.create = Translator.trans('New Building') : null\"><\/div>\n\n<!-- Create a Building -->\n<div ng-show=\"!tabs || currentModuleTab == 'create'\">\n    {% block %}\n        {% title %}{{ \"Create a new Building\" | trans }}{% endtitle %}\n        <form>\n            <input type=\"text\" ng-model=\"data.newBuilding.name\" placeholder=\"{{ 'Building name' | trans }}\" \/>\n            <input type=\"text\" ng-model=\"data.newBuilding.quantity\" placeholder=\"{{ 'Building default quantity' | trans }}\" \/>\n            <input type=\"text\" ng-model=\"data.newBuilding.picture\" placeholder=\"{{ 'Picture (prefixed with http:\/\/)' | trans }}\" \/>\n            {% button %}{{ \"Create this new Building\" | trans }}{% endbutton %}\n        <\/form>\n    {% endblock %}\n<\/div>\n\n<div ng-init=\"tabs ? tabs.edit = Translator.trans('All buildings') : null\"><\/div>\n\n<!-- Edit a Building -->\n<div ng-show=\"(!tabs || currentModuleTab == 'edit') && data.buildings && data.buildings.length\">\n    {% block %}\n        {% title %}{{ \"buildings of your game\" | trans }}{% endtitle %}\n        <ul class=\"collection\">\n            <li class=\"collection-item\">\n                <div class=\"btn pull-right\" ng-click=\"post()\"><i class=\"material-icons\">send<\/i><\/div>\n            <\/li>\n            <li ng-repeat=\"element in data.buildings\" class=\"collection-item row\">\n\n                <div class=\"col-md-3\">\n                    <label>{{ \"Name\" | trans }}<\/label>\n                    <input type=\"text\" ng-model=\"element.name\" ng-change=\"post()\" \/>\n                <\/div>\n                <div class=\"col-md-3\" ng-repeat=\"(propertyName, propertyValue) in element.properties\" ng-if=\"propertyName == 'picture' || propertyName == 'quantity'\">\n                    <label>{{ propertyName | trans }}<\/label>\n                    <input type=\"text\" ng-model=\"propertyValue\" \/>\n                <\/div>\n                <div class=\"col-md-3\">\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><\/span>\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><\/span>\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><!-- Delete the Building -->\n<a class=\"btn-floating btn-tiny waves-effect waves-light red\" ng-click=\"data.removeBuilding = element.name;post();\"><i class=\"tiny material-icons\">delete<\/i><\/a>\n<\/span>\n                <\/div>\n                <div class=\"clearfix\"><!-- Edit the stats of the Building -->\n<div ng-if=\"data.statsElementBuilding && elementTab == 'stats'+data.costsElementBuilding.id\">\n\n    <ul class=\"collection\">\n        <li class=\"collection-item row\">\n            <div class=\"col-md-3\">\n                <label>{{ \"Create a new stat\" | trans }}<\/label>\n            <\/div>\n            <div class=\"col-md-3\">\n                <input type=\"text\" ng-model=\"data.newStat.name\" placeholder=\"{{ 'Name of the stat' | trans }}\" \/>\n            <\/div>\n            <div class=\"col-md-3\">\n                <input type=\"text\" ng-model=\"data.newStat.quantity\" placeholder=\"{{ 'Default value for this stat' | trans }}\" \/>\n            <\/div>\n            <div class=\"col-md-3\">\n                <button ng-click=\"post()\" class=\"waves-effect waves-light btn\"><i class=\"material-icons\">send<\/i><\/button>\n            <\/div>\n        <\/li>\n        <li class=\"collection-item row\" ng-repeat=\"stat in data.buildingsStats\">\n            <div ng-repeat=\"property in data.statsElementBuilding.properties\" ng-if=\"property.name == stat.name\">\n                <div class=\"col-md-6\">\n                    <label>{{ property.name }}<\/label>\n                <\/div\/>\n                <div class=\"col-md-6\">\n                    <input type=\"text\" ng-model=\"property.value\" ng-change=\"post()\" \/>\n                <\/div>\n            <\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n<\/div>\n                <div class=\"clearfix\"><!-- Edit the costs of the Building -->\n<div ng-if=\"data.costsElementBuilding && elementTab == 'costs'+data.costsElementBuilding.id\">\n    Costs\n    <ul class=\"collection\">\n        <li ng-repeat=\"cost in data.costsElementBuilding.costs\" class=\"collection-item row\">\n            <div class=\"col-md-6\">\n                <label>{{ cost.cost.name }}<\/label\/>\n            <\/div>\n            <div class=\"col-md-6\">\n                <input type=\"text\" ng-change=\"post()\" ng-model=\"cost.quantity\" \/>\n            <\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n<\/div>\n            <\/li>\n            <li class=\"collection-item\">\n                <div class=\"btn pull-right\" ng-click=\"post()\"><i class=\"material-icons\">send<\/i><\/div>\n            <\/li>\n        <\/ul>\n    {% endblock %}\n<\/div>\n","game_controller":"<?php\n\n$arrayReturn = [];\n\n\/*\n* Get the buildings owned by the player\n*\/\n\n$buildings = $game->getElementsByProperties([\n    'type' => 'Building',\n]);\n\n$playerElements = [];\n\nif ($player) {\n    foreach ($buildings as $element) {\n        $playerElement = $player->getElement($element->getId());\n        if (!$playerElement) {\n            $playerElement = $player->createElement($element->getId());\n        }\n        $playerElements[] = $playerElement;\n    }\n\n    $arrayReturn['playerElements'] = $playerElements;\n}\n\n$arrayReturn['buildings'] = $buildings;\n\nif (isset($error)) {\n    $arrayReturn['error'] = $error;\n}\n\nreturn $arrayReturn;\n","game_template":"<!-- List buildings of the player -->\n<div ng-if=\"data.buildings.length\">\n    <div class=\"chip\" ng-repeat=\"playerElement in data.playerElements\">\n        <img ng-repeat=\"property in playerElement.element.properties\" ng-if=\"property.name == 'picture'\" ng-src=\"{{ property.value }}\" alt=\"{{ element.name }}\">\n        <span ng-repeat=\"property in playerElement.properties\" ng-if=\"property.name == 'quantity'\">\n            {{ property.value }}\n        <\/span>\n    <\/div>\n<\/div>\n"},"objects":{"admin_controller":"<?php\n\n$game->registerMenu('Objets');\n\n$newObject = $game->createElementIfInRequest('newObject', [\n    'type' => 'Object',\n    'usable' => true,\n]);\n\n$game->deleteElementIfInRequest('removeObject');\n\nif ($request->get('currentObject')) {\n    $object = $game->getElement($request->get('currentObject')['id']);\n    foreach ($request->get('currentObject')['properties'] as $property) {\n        $object->set($property['name'], $property['value']);\n    }\n    if ($request->get('newEffect')) {\n        $effect = $object->createEffect($request->get('newEffect')['propertyName'], $request->get('newEffect')['quantity']);\n    }\n}\n\n$objects = $game->getElementsByProperties([\n    'type' => 'Object',\n]);\n\nreturn [\n    'objects' => $objects,\n    'properties' => $game->getElementsProperties(),\n];\n","admin_template":"<div class=\"row card\">\n    <div class=\"col s12\">\n      <ul class=\"tabs\">\n        <li class=\"tab col s3\"><a ng-click=\"currentTab = 'all'; currentObject = null\">All Objects<\/a><\/li>\n        <li class=\"tab col s3\"><a class=\"active\" ng-click=\"currentTab = 'new'\">New Object<\/a><\/li>\n      <\/ul>\n    <\/div>\n<\/div>\n\n<div ng-if=\"currentTab == 'new' || (!data.objects.length && !currentTab)\">\n    {% block %}\n        {% title %}New object{% endtitle %}\n        <input type=\"text\" placeholder=\"Name of the object\" ng-model=\"data.newObject.name\" \/>\n        <input type=\"text\" placeholder=\"Picture of the object\" ng-model=\"data.newObject.picture\" \/>\n        <button class=\"btn\" ng-click=\"post()\">Create this object<\/button>\n    {% endblock %}\n<\/div>\n\n<div ng-if=\"currentTab == 'all' || (!data.currentObject && data.objects.length && !currentTab)\">\n    {% block %}\n    <ul class=\"collection\">\n        <li class=\"collection-item clear row\" ng-repeat=\"object in data.objects\">\n            <span class=\"col-md-6\">{{ object.name }}<\/span>\n            <span class=\"col-md-6\">\n                <button class=\"btn\" ng-click=\"data.currentObject = object\">Edit<\/button>\n            <\/span>\n        <\/li>\n    <\/ul>\n    <div class=\"clear\"><\/div>\n    {% endblock %}\n<\/div>\n\n<div ng-if=\"data.currentObject && (currentTab == 'all' || !currentTab)\">\n    {% block %}\n        {% title %}Properties of {{ data.currentObject.name }}{% endtitle %}\n        <ul class=\"collection\">\n            <li class=\"row collection-item\" ng-repeat=\"property in data.currentObject.properties\" ng-if=\"property.name != 'isObject'\">\n                <span class=\"col-md-6\">{{ property.name }}<\/span>\n                <span class=\"col-md-6\"><input type=\"text\" ng-model=\"property.value\" \/><\/span>\n            <\/li>\n        <\/ul>\n        <button class=\"btn\" ng-click=\"post()\">Save<\/button>\n    {% endblock %}\n    {% block %}\n        <div ng-if=\"data.currentObject.effects.length\">\n            {% title %}Effects of {{ data.currentObject.name }}{% endtitle %}\n            <ul class=\"collection\">\n                <li class=\"row collection-item\" ng-repeat=\"effect in data.currentObject.effects\">\n                    <span class=\"col-md-6\">{{ effect.property_name }}<\/span>\n                    <span class=\"col-md-6\"><input type=\"text\" ng-model=\"effect.quantity\" \/><\/span>\n                <\/li>\n            <\/ul>\n            <button class=\"btn\" ng-click=\"post()\">Save<\/button>\n        <\/div>\n    {% endblock %}\n    {% block %}\n        {% title %}New effect{% endtitle %}\n        <select ng-model=\"data.newEffect.propertyName\">\n            <option disabled selected>( Select a property )<\/option>\n            <option ng-repeat=\"property in data.properties\" value=\"{{ property.name }}\">\n                {{ property.name }}\n            <\/option>\n        <\/select>\n        <input type=\"text\" ng-model=\"data.newEffect.quantity\" ng-model=\"Effect\" \/>\n        <button class=\"btn\" ng-click=\"post()\">Create effect<\/button>\n    {% endblock %}\n<\/div>\n","game_controller":"<?php\n\n$game->registerMenu('Objets');\n\nif ($player) {\n    $objects = $game->getElementsByProperties([\n        'type' => 'Object',\n    ]);\n\n    foreach ($objects as $object) {\n        if (!$player->getElement($object)) {\n            $player->createElement($object->id, 0);\n        }\n    }\n\n    if ($request->get('playerObjects')) {\n        foreach ($request->get('playerObjects') as $object) {\n            if (isset($object['data']) && $object['data']) {\n                $playerElement = $player->getElement($object['element']['id']);\n                $playerElement->set('quantity', $playerElement->get('quantity') + (int) $object['data']);\n            }\n        }\n    }\n\n    if ($request->get('currentObject')) {\n        $playerElement = $player->getElement($request->get('currentObject')['element']['id']);\n        $playerElement->set('quantity', $playerElement->get('quantity') - 1);\n    }\n\n    $playerObjects = $player->getElementsByProperties([\n        'type' => 'Object',\n    ]);\n\n    return [\n        'objects' => $objects,\n        'playerObjects' => $playerObjects,\n    ];\n}\n\nreturn [];\n","game_template":"<div class=\"card horizontal\" ng-repeat=\"object in data.playerObjects\">\n    <div class=\"card-image\">\n        <img ng-repeat=\"property in object.element.properties\" ng-if=\"property.name == 'picture'\" ng-src=\"{{ property.value }}\">\n    <\/div>\n    <div class=\"card-content\">\n        <div class=\"card-title\">\n            {{ object.element.name }}\n            <span ng-repeat=\"property in object.properties\" ng-if=\"property.name == 'quantity'\">\n                ({{ property.value }})\n            <\/span>\n        <\/div>\n        <div class=\"row\">\n            <div class=\"col-md-4\">\n                Effects: <br \/>\n                <div ng-repeat=\"effect in object.element.effects\">\n                    <span ng-if=\"effect.quantity > 0\">+<\/span> {{ effect.quantity }}\n                    {{ effect.property_name }}\n                <\/div>\n                <button class=\"btn\" ng-click=\"data.currentObject = object; post()\">Use it!<\/button>\n            <\/div>\n            <div class=\"col-md-4\">\n                <input type=\"text\"  ng-model=\"object.data\" placeholder=\"Quantity to buy\" \/>\n            <\/div>\n            <div class=\"col-md-4\">\n                <button class=\"btn\" ng-click=\"post()\">Buy!<\/button>\n            <\/div>\n        <\/div>\n    <\/div>\n<\/div>\n"},"resources":{"admin_controller":"<?php\n\n$arrayReturn = [];\n\n\/*\n* Add module resources to the game menu\n*\/\n\n$game->registerMenu('resources');\n\n\/*\n* Create a new Resource\n*\/\n\n$newResource = null;\n\n$newResource = $game->createElementIfInRequest('newResource', [\n    'type' => 'Resource',\n]);\n\n\/*\n* Edit an existant Resource\n*\/\n\n$game->updateElementsIfInRequest('resources');\n\n\/*\n* Delete a Resource\n*\/\n\n$game->deleteElementIfInRequest('removeResource');\n\n\/*\n* Retrieve all resources\n*\/\n\n$arrayReturn['resources'] = $game->getElementsByProperties([\n    'type' => 'Resource',\n]);\n\nreturn $arrayReturn;\n","admin_template":"<!-- Tabs -->\n<div ng-init=\"$parent.tabs = {}; $parent.currentModuleTab=false\"><\/div>\n\n<div class=\"row card\">\n    <div class=\"col s12\">\n      <ul class=\"tabs\">\n        <li class=\"tab col s3\" ng-repeat=\"(key, tabName) in tabs\">\n            <a ng-click=\"$parent.currentModuleTab = key\" ng-class=\"{active: $parent.currentModuleTab == key}\">\n                {{ tabName }}\n            <\/a>\n        <\/li>\n      <\/ul>\n    <\/div>\n<\/div>\n\n<div ng-init=\"tabs ? tabs.create = Translator.trans('New Resource') : null\"><\/div>\n\n<!-- Create a Resource -->\n<div ng-show=\"!tabs || currentModuleTab == 'create'\">\n    {% block %}\n        {% title %}{{ \"Create a new Resource\" | trans }}{% endtitle %}\n        <form>\n            <input type=\"text\" ng-model=\"data.newResource.name\" placeholder=\"{{ 'Resource name' | trans }}\" \/>\n            <input type=\"text\" ng-model=\"data.newResource.quantity\" placeholder=\"{{ 'Resource default quantity' | trans }}\" \/>\n            <input type=\"text\" ng-model=\"data.newResource.picture\" placeholder=\"{{ 'Picture (prefixed with http:\/\/)' | trans }}\" \/>\n            {% button %}{{ \"Create this new Resource\" | trans }}{% endbutton %}\n        <\/form>\n    {% endblock %}\n<\/div>\n\n<div ng-init=\"tabs ? tabs.edit = Translator.trans('All resources') : null\"><\/div>\n\n<!-- Edit a Resource -->\n<div ng-show=\"(!tabs || currentModuleTab == 'edit') && data.resources && data.resources.length\">\n    {% block %}\n        {% title %}{{ \"resources of your game\" | trans }}{% endtitle %}\n        <ul class=\"collection\">\n            <li class=\"collection-item\">\n                <div class=\"btn pull-right\" ng-click=\"post()\"><i class=\"material-icons\">send<\/i><\/div>\n            <\/li>\n            <li ng-repeat=\"element in data.resources\" class=\"collection-item row\">\n\n                <div class=\"col-md-3\">\n                    <label>{{ \"Name\" | trans }}<\/label>\n                    <input type=\"text\" ng-model=\"element.name\" ng-change=\"post()\" \/>\n                <\/div>\n                <div class=\"col-md-3\" ng-repeat=\"(propertyName, propertyValue) in element.properties\" ng-if=\"propertyName == 'picture' || propertyName == 'quantity'\">\n                    <label>{{ propertyName | trans }}<\/label>\n                    <input type=\"text\" ng-model=\"propertyValue\" \/>\n                <\/div>\n                <div class=\"col-md-3\">\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><\/span>\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><\/span>\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><!-- Delete the Resource -->\n<a class=\"btn-floating btn-tiny waves-effect waves-light red\" ng-click=\"data.removeResource = element.name;post();\"><i class=\"tiny material-icons\">delete<\/i><\/a>\n<\/span>\n                <\/div>\n                <div class=\"clearfix\"><!-- Edit the stats of the Resource -->\n<div ng-if=\"data.statsElementResource && elementTab == 'stats'+data.costsElementResource.id\">\n\n    <ul class=\"collection\">\n        <li class=\"collection-item row\">\n            <div class=\"col-md-3\">\n                <label>{{ \"Create a new stat\" | trans }}<\/label>\n            <\/div>\n            <div class=\"col-md-3\">\n                <input type=\"text\" ng-model=\"data.newStat.name\" placeholder=\"{{ 'Name of the stat' | trans }}\" \/>\n            <\/div>\n            <div class=\"col-md-3\">\n                <input type=\"text\" ng-model=\"data.newStat.quantity\" placeholder=\"{{ 'Default value for this stat' | trans }}\" \/>\n            <\/div>\n            <div class=\"col-md-3\">\n                <button ng-click=\"post()\" class=\"waves-effect waves-light btn\"><i class=\"material-icons\">send<\/i><\/button>\n            <\/div>\n        <\/li>\n        <li class=\"collection-item row\" ng-repeat=\"stat in data.resourcesStats\">\n            <div ng-repeat=\"property in data.statsElementResource.properties\" ng-if=\"property.name == stat.name\">\n                <div class=\"col-md-6\">\n                    <label>{{ property.name }}<\/label>\n                <\/div\/>\n                <div class=\"col-md-6\">\n                    <input type=\"text\" ng-model=\"property.value\" ng-change=\"post()\" \/>\n                <\/div>\n            <\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n<\/div>\n                <div class=\"clearfix\"><!-- Edit the costs of the Resource -->\n<div ng-if=\"data.costsElementResource && elementTab == 'costs'+data.costsElementResource.id\">\n    Costs\n    <ul class=\"collection\">\n        <li ng-repeat=\"cost in data.costsElementResource.costs\" class=\"collection-item row\">\n            <div class=\"col-md-6\">\n                <label>{{ cost.cost.name }}<\/label\/>\n            <\/div>\n            <div class=\"col-md-6\">\n                <input type=\"text\" ng-change=\"post()\" ng-model=\"cost.quantity\" \/>\n            <\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n<\/div>\n            <\/li>\n            <li class=\"collection-item\">\n                <div class=\"btn pull-right\" ng-click=\"post()\"><i class=\"material-icons\">send<\/i><\/div>\n            <\/li>\n        <\/ul>\n    {% endblock %}\n<\/div>\n","game_controller":"<?php\n\n$arrayReturn = [];\n\n\/*\n* Get the resources owned by the player\n*\/\n\n$resources = $game->getElementsByProperties([\n    'type' => 'Resource',\n]);\n\n$playerElements = [];\n\nif ($player) {\n    foreach ($resources as $element) {\n        $playerElement = $player->getElement($element->getId());\n        if (!$playerElement) {\n            $playerElement = $player->createElement($element->getId());\n        }\n        $playerElements[] = $playerElement;\n    }\n\n    $arrayReturn['playerElements'] = $playerElements;\n}\n\n$arrayReturn['resources'] = $resources;\n\nif (isset($error)) {\n    $arrayReturn['error'] = $error;\n}\n\nreturn $arrayReturn;\n","game_template":"<!-- List resources of the player -->\n<div ng-if=\"data.resources.length\">\n    <div class=\"chip\" ng-repeat=\"playerElement in data.playerElements\">\n        <img ng-repeat=\"property in playerElement.element.properties\" ng-if=\"property.name == 'picture'\" ng-src=\"{{ property.value }}\" alt=\"{{ element.name }}\">\n        <span ng-repeat=\"property in playerElement.properties\" ng-if=\"property.name == 'quantity'\">\n            {{ property.value }}\n        <\/span>\n    <\/div>\n<\/div>\n"},"units":{"admin_controller":"<?php\n\n$arrayReturn = [];\n\n\/*\n* Add module units to the game menu\n*\/\n\n$game->registerMenu('units');\n\n\/*\n* Create a new Unit\n*\/\n\n$newUnit = null;\n\n$newUnit = $game->createElementIfInRequest('newUnit', [\n    'type' => 'Unit',\n]);\n\n\/*\n* Edit stats of units\n*\/\n\n\/\/ By default no stats\nif (!$game->get('unitsStats')) {\n    $game->set('unitsStats', []);\n}\n\n\/\/ Updating stats\nif ($request->get('unitsStats')) {\n    $game->set('unitsStats', $request->get('unitsStats'));\n}\n\n\/\/ Creating a new stat\nif ($request->get('newStat')) {\n    $gameStats = $game->get('unitsStats');\n    $gameStats[] = $request->get('newStat');\n    $game->set('unitsStats', $gameStats);\n}\n\n\/\/ Delete a stat\nif ($request->get('removeUnitStat')) {\n    $gameStats = $game->get('unitsStats');\n    $newStats = [];\n    foreach ($gameStats as $stat) {\n        if ($stat->name != $request->get('removeUnitStat')['name']) {\n            $newStats[] = $stat;\n        }\n    }\n\n    $game->set('unitsStats', $newStats);\n}\n\n\/\/ Apply default stats to all elements\n$gameStats = $arrayReturn['unitsStats'] = $game->get('unitsStats');\n\n$elements = $game->getElementsByProperties(['type' => 'Unit']);\nforeach ($gameStats as $stat) {\n    foreach ($elements as $element) {\n        if (!$element->get($stat->name)) {\n            $element->set($stat->name, (int) $stat->quantity);\n        }\n        if ($request->get('removeUnitStat')) {\n            $element->removeProperty($request->get('removeUnitStat')['name']);\n        }\n    }\n}\n\n\/*\n* Edit costs of an Unit\n*\/\n\n\/\/ Update costs of a Unit\nif ($request->get('costsElementUnit')) {\n    $currentUnit = (array) $request->get('costsElementUnit');\n    $elementUnit = $game->getElement($currentUnit['id']);\n    foreach ($currentUnit['costs'] as $costInfos) {\n        $costInfos = (array) $costInfos;\n        $costInfos['cost'] = (array) $costInfos['cost'];\n        $createdCosts[] = $elementUnit->createCost($costInfos['cost']['id'], $costInfos['quantity']);\n    }\n    $arrayReturn['costsElementUnit'] = $request->get('costsElementUnit');\n}\n\n$elements = $game->getElementsByProperties(['type' => 'Unit']);\n$moneys = $game->getElementsByProperties(['type' => 'Resource']);\n\n\/\/ Apply default costs to units\nforeach ($elements as $element) {\n    $costs = $element->getCosts();\n    foreach ($moneys as $money) {\n        if (!$element->getCost($money)) {\n            $element->createCost($money, 0);\n        }\n    }\n}\n\n\/*\n* Edit an existant Unit\n*\/\n\n$game->updateElementsIfInRequest('units');\n\n\/*\n* Delete a Unit\n*\/\n\n$game->deleteElementIfInRequest('removeUnit');\n\n\/*\n* Retrieve all units\n*\/\n\n$arrayReturn['units'] = $game->getElementsByProperties([\n    'type' => 'Unit',\n]);\n\nreturn $arrayReturn;\n","admin_template":"<!-- Tabs -->\n<div ng-init=\"$parent.tabs = {}; $parent.currentModuleTab=false\"><\/div>\n\n<div class=\"row card\">\n    <div class=\"col s12\">\n      <ul class=\"tabs\">\n        <li class=\"tab col s3\" ng-repeat=\"(key, tabName) in tabs\">\n            <a ng-click=\"$parent.currentModuleTab = key\" ng-class=\"{active: $parent.currentModuleTab == key}\">\n                {{ tabName }}\n            <\/a>\n        <\/li>\n      <\/ul>\n    <\/div>\n<\/div>\n\n<div ng-if=\"data.error\">\n    <div class=\"card red\">\n        <div class=\"card-content white-text\">\n            <i class=\"material-icons\">error_outline<\/i> <span style=\"position: relative;top: -7px;\">{{ data.error.message  }}<\/span>\n        <\/div>\n    <\/div>\n<\/div>\n\n<div ng-init=\"tabs ? tabs.create = Translator.trans('New Unit') : null\"><\/div>\n\n<!-- Create a Unit -->\n<div ng-show=\"!tabs || currentModuleTab == 'create'\">\n    {% block %}\n        {% title %}{{ \"Create a new Unit\" | trans }}{% endtitle %}\n        <form>\n            <input type=\"text\" ng-model=\"data.newUnit.name\" placeholder=\"{{ 'Unit name' | trans }}\" \/>\n            <input type=\"text\" ng-model=\"data.newUnit.quantity\" placeholder=\"{{ 'Unit default quantity' | trans }}\" \/>\n            <input type=\"text\" ng-model=\"data.newUnit.picture\" placeholder=\"{{ 'Picture (prefixed with http:\/\/)' | trans }}\" \/>\n            {% button %}{{ \"Create this new Unit\" | trans }}{% endbutton %}\n        <\/form>\n    {% endblock %}\n<\/div>\n\n<div ng-init=\"tabs ? tabs.edit = Translator.trans('All units') : null\"><\/div>\n\n<!-- Edit a Unit -->\n<div ng-show=\"(!tabs || currentModuleTab == 'edit') && data.units && data.units.length\">\n    {% block %}\n        {% title %}{{ \"units of your game\" | trans }}{% endtitle %}\n        <ul class=\"collection\">\n            <li class=\"collection-item\">\n                <div class=\"btn pull-right\" ng-click=\"post()\"><i class=\"material-icons\">send<\/i><\/div>\n            <\/li>\n            <li ng-repeat=\"element in data.units\" class=\"collection-item row\">\n\n                <div class=\"col-md-3\">\n                    <label>{{ \"Name\" | trans }}<\/label>\n                    <input type=\"text\" ng-model=\"element.name\" ng-change=\"post()\" \/>\n                <\/div>\n                <div class=\"col-md-3\" ng-repeat=\"(propertyName, propertyValue) in element.properties\" ng-if=\"propertyName == 'picture' || propertyName == 'quantity'\">\n                    <label>{{ propertyName | trans }}<\/label>\n                    <input type=\"text\" ng-model=\"propertyValue\" \/>\n                <\/div>\n                <div class=\"col-md-3\">\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><!-- Button for edit the stats of the Unit -->\n<a class=\"btn-floating btn-tiny waves-effect waves-light blue\" ng-click=\"elementTab = 'stats'+element.id; data.statsElementUnit = element\"><i class=\"fa fa-bar-chart\"><\/i><\/a>\n<\/span>\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><!-- Button for edit the costs of the Unit -->\n<a class=\"btn-floating btn-tiny waves-effect waves-light green\" ng-click=\"elementTab = 'costs'+element.id; data.costsElementUnit = element\"><i class=\"fa fa-money\"><\/i><\/a>\n<\/span>\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\"><!-- Delete the Unit -->\n<a class=\"btn-floating btn-tiny waves-effect waves-light red\" ng-click=\"data.removeUnit = element.name;post();\"><i class=\"tiny material-icons\">delete<\/i><\/a>\n<\/span>\n                <\/div>\n                <div class=\"clearfix\"><!-- Edit the stats of the Unit -->\n<div ng-if=\"data.statsElementUnit && elementTab == 'stats'+data.costsElementUnit.id\">\n\n    <ul class=\"collection\">\n        <li class=\"collection-item row\">\n            <div class=\"col-md-3\">\n                <label>{{ \"Create a new stat\" | trans }}<\/label>\n            <\/div>\n            <div class=\"col-md-3\">\n                <input type=\"text\" ng-model=\"data.newStat.name\" placeholder=\"{{ 'Name of the stat' | trans }}\" \/>\n            <\/div>\n            <div class=\"col-md-3\">\n                <input type=\"text\" ng-model=\"data.newStat.quantity\" placeholder=\"{{ 'Default value for this stat' | trans }}\" \/>\n            <\/div>\n            <div class=\"col-md-3\">\n                <button ng-click=\"post()\" class=\"waves-effect waves-light btn\"><i class=\"material-icons\">send<\/i><\/button>\n            <\/div>\n        <\/li>\n        <li class=\"collection-item row\" ng-repeat=\"stat in data.unitsStats\">\n            <div ng-repeat=\"property in data.statsElementUnit.properties\" ng-if=\"property.name == stat.name\">\n                <div class=\"col-md-6\">\n                    <label>{{ property.name }}<\/label>\n                <\/div\/>\n                <div class=\"col-md-6\">\n                    <input type=\"text\" ng-model=\"property.value\" ng-change=\"post()\" \/>\n                <\/div>\n            <\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n<\/div>\n                <div class=\"clearfix\"><!-- Edit the costs of the Unit -->\n<div ng-if=\"data.costsElementUnit && elementTab == 'costs'+data.costsElementUnit.id\">\n    Costs\n    <ul class=\"collection\">\n        <li ng-repeat=\"cost in data.costsElementUnit.costs\" class=\"collection-item row\">\n            <div class=\"col-md-6\">\n                <label>{{ cost.cost.name }}<\/label\/>\n            <\/div>\n            <div class=\"col-md-6\">\n                <input type=\"text\" ng-change=\"post()\" ng-model=\"cost.quantity\" \/>\n            <\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n<\/div>\n            <\/li>\n            <li class=\"collection-item\">\n                <div class=\"btn pull-right\" ng-click=\"post()\"><i class=\"material-icons\">send<\/i><\/div>\n            <\/li>\n        <\/ul>\n    {% endblock %}\n<\/div>\n\n<div ng-init=\"tabs ? tabs.stats = Translator.trans('Stats') : null\"><\/div>\n\n<div ng-if=\"currentModuleTab == 'stats'\">\n{% block %}\n    {% title %}New stat{% endtitle %}\n    <input type=\"text\" placeholder=\"{{ 'Name of the stat' | trans }}\" ng-model=\"data.newStat.name\" \/>\n    <input type=\"text\" placeholder=\"{{ 'Default value of the stat' | trans }}\" ng-model=\"data.newStat.quantity\" \/>\n    <button class=\"btn\" ng-click=\"post()\">{{ 'Create this stat' |\u00a0trans }}<\/button>\n{% endblock %}\n\n<div ng-if=\"data.unitsStats.length\">\n    {% block %}\n        {% title %}{{ \"Stats\" | trans }}{% endtitle %}\n        <ul class=\"collection\">\n            <li class=\"collection-item row\" ng-repeat=\"stat in data.unitsStats\">\n                <span class=\"col-md-4\"><input type=\"text\" ng-model=\"stat.name\" \/><\/span>\n                <span class=\"col-md-4\"><input type=\"text\" ng-model=\"stat.quantity\" \/><\/span>\n                <span class=\"col-md-4\">\n                    <span class=\"pull-right\" style=\"margin-right: 10px;margin-top: 25px;\">\n                        <a class=\"btn-floating btn-tiny waves-effect waves-light red\" ng-click=\"data.removeUnitStat = stat;post();\"><i class=\"tiny material-icons\">delete<\/i><\/a>\n                    <\/span>\n                <\/span>\n            <\/li>\n            <li class=\"collection-item\">\n                <button class=\"btn\" ng-click=\"post()\">{{ \"Update stats\" | trans }}<\/button>\n            <\/li>\n        <\/ul>\n    {% endblock %}\n    <\/div>\n<\/div>\n","game_controller":"<?php\n\n$arrayReturn = [];\n\n\/*\n* Buy a Unit\n*\/\n\nif ($request->get('playerElements')) {\n    foreach ($request->get('playerElements') as $playerElement) {\n        if (isset($playerElement['data']) && (int) $playerElement['data'] > 0) {\n            $playerElementEntity = $player->getElement($playerElement['element']['id']);\n            try {\n                $playerElementEntity->set('quantity', (int) $playerElementEntity->get('quantity') + (int) $playerElement['data']);\n            } catch (Exception $e) {\n                $error = $e->getMessage();\n            }\n        }\n    }\n}\n\n\/*\n* Get the units owned by the player\n*\/\n\n$units = $game->getElementsByProperties([\n    'type' => 'Unit',\n]);\n\n$playerElements = [];\n\nif ($player) {\n    foreach ($units as $element) {\n        $playerElement = $player->getElement($element->getId());\n        if (!$playerElement) {\n            $playerElement = $player->createElement($element->getId());\n        }\n        $playerElements[] = $playerElement;\n    }\n\n    $arrayReturn['playerElements'] = $playerElements;\n}\n\n$arrayReturn['units'] = $units;\n\n\/*\n*   List stats of units\n*\/\n\n$arrayReturn['unitsStats'] = $game->get('unitsStats');\n\nif (isset($error)) {\n    $arrayReturn['error'] = $error;\n}\n\nreturn $arrayReturn;\n","game_template":"<!-- List units of the player -->\n<div ng-if=\"data.playerElements.length\">\n    <ul class=\"collection\">\n        <li class=\"collection-item row\" ng-repeat=\"playerElement in data.playerElements\">\n            <div class=\"col-md-1\">\n                <img ng-repeat=\"property in playerElement.element.properties\" ng-if=\"property.name == 'picture'\" ng-src=\"{{ property.value }}\" alt=\"{{ element.name }}\">\n            <\/div>\n            <div class=\"col-md-4\">\n                <h5>{{ playerElement.element.name }} <small ng-repeat=\"property in playerElement.properties\" ng-if=\"property.name == 'quantity'\">x{{ property.value }}<\/small><\/h5>\n                <!-- Stats for the playerElement -->\n<ul class=\"collection row\">\n    <li ng-repeat=\"stat in data.unitsStats\">\n        <span class=\"col-md-6\">{{ stat.name }}<\/span>\n        <span class=\"col-md-6\" ng-repeat=\"property in playerElement.properties\" ng-if=\"property.name == stat.name\">{{ property.value }}<\/span>\n    <li>\n<\/ul>\n\n            <\/div>\n            <div class=\"col-md-4\">\n                <input type=\"text\" placeholder=\"{{ 'How many to buy?' | trans }}'\" ng-model=\"playerElement.data\" \/>\n            <\/div>\n            <div class=\"col-md-1\">\n                <button class=\"btn\" ng-click=\"post()\">\n                    <i class=\"material-icons\">send<\/i>\n                <\/button>\n            <\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n"},"races":{"admin_controller":"<?php\n\nif ($request->get('introduction')) {\n    $module->set('introduction', $request->get('introduction'));\n} elseif (!$module->get('introduction')) {\n    $module->set('introduction', false);\n}\n\n$newRace = null;\n$arrayReturn = [];\n\n$newRace = $game->createElementIfInRequest('newRace', [\n    'type' => 'Race',\n]);\n\n\/\/ Delete Race if removeRace is sent\n$game->deleteElementIfInRequest('removeRace');\n\n\/\/ Update races properties if is sent\n$game->updateElementsIfInRequest('races');\n\n$races = $game->getElementsByProperties(['type' => 'Race']);\n\n$game->registerFilter('Race');\n\nreturn [\n    'races' => $races,\n    'introduction' => $module->get('introduction'),\n];\n","admin_template":"{% block %}\n    {% title %}Page d'introduction{% endtitle %}\n    <textarea placeholder=\"Texte d'ambiance: choisissez votre race, etc.\" ng-model=\"data.introduction\" ng-repeat=\"property in module.properties\" ng-if=\"property.name='introduction'\">\n    <\/textarea>\n    <button class=\"btn\" ng-click=\"post()\">Update<\/button>\n{% endblock %}\n\n{% block %}\n    {% title %}New race{% endtitle %}\n    <input type=\"text\" ng-model=\"data.newRace.name\" placeholder=\"Name of the race\" \/>\n    <input type=\"text\" ng-model=\"data.newRace.picture\" placeholder=\"Picture of the race\" \/>\n    <textarea placeholder=\"Description of this race\" ng-model=\"data.newRace.description\"><\/textarea>\n    <button class=\"btn\" ng-click=\"post()\">Create this race<\/button>\n{% endblock %}\n\n<div ng-if=\"data.races.length\">\n{% block %}\n    <button class=\"btn pull-right\" ng-click=\"post()\">Update<\/button>\n    {% title %}Races{% endtitle %}\n    <ul class=\"collection\">\n        <li ng-repeat=\"race in data.races\">\n            <div class=\"row\">\n                <div class=\"col-md-4\">\n                    <label>Name<\/label>\n                    <input type=\"text\" ng-model=\"race.name\" \/>\n                <\/div>\n                <div class=\"col-md-4\">\n                    <label>Picture<\/label>\n                    <input ng-repeat=\"property in race.properties\" ng-if=\"property.name=='picture'\" type=\"text\" ng-model=\"property.value\" \/>\n                <\/div>\n                <div class=\"col-md-4\">\n                    <label>Description<\/label>\n                    <textarea ng-repeat=\"property in race.properties\" ng-if=\"property.name=='description'\" ng-model=\"property.value\" ng-bind=\"property.value\"><\/textarea>\n                <\/div>\n            <\/div>\n        <\/li>\n    <\/ul>\n    <button class=\"btn pull-right\" ng-click=\"post()\">Update<\/button>\n    <div class=\"clear\"><\/div>\n{% endblock %}\n<\/div>\n","game_controller":"<?php\n\n$races = $game->getElementsByProperties(['type' => 'Race']);\n\nif ($request->get('chosenRace')) {\n    $player->set('Race', $request->get('chosenRace')['id']);\n}\n\n$playerRace = $player->get('Race');\nif ($playerRace) {\n    $playerRace = $game->getElement($playerRace);\n}\n\nreturn [\n    'races' => $races,\n    'playerRace' => $playerRace,\n    'introduction' => $module->get('introduction'),\n];\n","game_template":"<div ng-if=\"!data.playerRace\">\n    {% block %}\n        {% title %}\n            {{ data.introduction }}\n        {% endtitle %}\n    {% endblock %}\n    <div ng-repeat=\"race in data.races\" class=\"card horizontal\">\n        <div class=\"card-image\">\n            <img ng-repeat=\"property in race.properties\" ng-if=\"property.name == 'picture'\" ng-src=\"{{ property.value }}\" \/>\n        <\/div>\n        <div class=\"card-content\">\n            <div class=\"card-title\">\n                {{ race.name }}\n                <p>{{ race.description }}<\/p>\n                <button class=\"btn\" ng-click=\"data.chosenRace = race; post()\">I want to be a {{ race.name }}!<\/button>\n            <\/div>\n        <\/div>\n    <\/div>\n<\/div>\n<div ng-if=\"data.playerRace\">\n    You are a {{ data.playerRace.name }}\n<\/div>\n"},"character":{"admin_controller":"<?php\n\n$game->registerMenu('Personnage');\n$game->registerTrigger('xp', function () {\n    if ($player->get('xp') >= $player->get('level') * 1500) {\n        $player->set('xp', 0);\n        $player->set('level', $player->get('level') + 1);\n    }\n});\n\nreturn [];\n","admin_template":"{% block %}Hello Jcray! This is my module!{% endblock %}\n","game_controller":"<?php\n\n$game->registerMenu('Personnage');\n\nif (!$player->get('level')) {\n    $player->set('level', 1);\n}\n\nif (!$player->get('xp')) {\n    $player->set('xp', 0);\n}\n\n$player->set('xp', 6000);\n\nreturn [];\n","game_template":"{% block %}\n    {% title %}{{ player.pseudo }}{% endtitle %}\n    <ul class=\"collection\">\n        <li class=\"collection-item\">\n            Level:\n            <span ng-repeat=\"property in player.properties\" ng-if=\"property.name=='level'\">\n                {{ property.value }}\n            <\/span>\n        <\/li>\n\n        <li class=\"collection-item\">\n            Xp:\n            <span ng-repeat=\"property in player.properties\" ng-if=\"property.name=='xp'\">\n                {{ property.value }}\n            <\/span>\n        <\/li>\n        <li class=\"collection-item\" ng-repeat=\"playerElement in data.filters\">\n            {{ filter.property_name }}\n            <span ng-repeat=\"property in player.properties\" ng-if=\"property.name == filter.property_name\">\n                {{ property.value }}\n            <\/span>\n        <\/li>\n    <\/ul>\n{% endblock %}\n"}};